name: "namedot"
arch: "amd64"
platform: "linux"
version: "${VERSION}"
section: "net"
priority: "optional"
maintainer: "Sergei Vorontsov <piligrim@rootnix.net>"
description: |
  Lightweight DNS server with REST API and GeoDNS support
  .
  Features:
  - UDP/TCP DNS server
  - REST API for zone management
  - GeoDNS with country/continent/subnet support
  - SQLite/PostgreSQL/MySQL backend
  - Master-Slave replication
  - Web admin panel
vendor: "namedot"
homepage: "https://github.com/foxzi/namedot"
license: "MIT"

contents:
  # Binary
  - src: ./namedot
    dst: /usr/bin/namedot
    file_info:
      mode: 0755

  # Configuration directory
  - dst: /etc/namedot
    type: dir
    file_info:
      mode: 0750
      owner: root
      group: namedot

  # Configuration
  - src: ./packaging/config/config.yaml
    dst: /etc/namedot/config.yaml
    type: config
    file_info:
      mode: 0750
      owner: root
      group: namedot

  # Systemd service
  - src: ./packaging/systemd/namedot.service
    dst: /lib/systemd/system/namedot.service
    file_info:
      mode: 0644

  # Create directories
  - dst: /var/lib/namedot
    type: dir
    file_info:
      mode: 0755
      owner: namedot
      group: namedot

  - dst: /var/log/namedot
    type: dir
    file_info:
      mode: 0755
      owner: namedot
      group: namedot

  - dst: /var/lib/namedot/geoipdb
    type: dir
    file_info:
      mode: 0755
      owner: namedot
      group: namedot

  # Documentation directory
  - dst: /usr/share/doc/namedot
    type: dir
    file_info:
      mode: 0755

  # Documentation files
  - src: ./docs/README.md
    dst: /usr/share/doc/namedot/README.md
    file_info:
      mode: 0644

  - src: ./docs/REPLICATION.md
    dst: /usr/share/doc/namedot/REPLICATION.md
    file_info:
      mode: 0644

  - src: ./docs/DOCKER.md
    dst: /usr/share/doc/namedot/DOCKER.md
    file_info:
      mode: 0644

  - src: ./docs/WEBADMIN.md
    dst: /usr/share/doc/namedot/WEBADMIN.md
    file_info:
      mode: 0644

  - src: ./docs/PACKAGE_DOCS.md
    dst: /usr/share/doc/namedot/PACKAGE_DOCS.md
    file_info:
      mode: 0644

  - src: ./LICENSE
    dst: /usr/share/doc/namedot/LICENSE
    file_info:
      mode: 0644

  # Configuration examples directory
  - dst: /usr/share/doc/namedot/examples
    type: dir
    file_info:
      mode: 0755

  # Configuration examples
  - src: ./docs/examples/README.md
    dst: /usr/share/doc/namedot/examples/README.md
    file_info:
      mode: 0644

  - src: ./docs/examples/config.yaml
    dst: /usr/share/doc/namedot/examples/config.yaml
    file_info:
      mode: 0644

  - src: ./docs/examples/config.master.yaml
    dst: /usr/share/doc/namedot/examples/config.master.yaml
    file_info:
      mode: 0644

  - src: ./docs/examples/config.slave.yaml
    dst: /usr/share/doc/namedot/examples/config.slave.yaml
    file_info:
      mode: 0644

  - src: ./docs/examples/config.mysql.yaml
    dst: /usr/share/doc/namedot/examples/config.mysql.yaml
    file_info:
      mode: 0644

  - src: ./docs/examples/config.postgres.yaml
    dst: /usr/share/doc/namedot/examples/config.postgres.yaml
    file_info:
      mode: 0644

  - src: ./docs/examples/config.docker.yaml
    dst: /usr/share/doc/namedot/examples/config.docker.yaml
    file_info:
      mode: 0644

scripts:
  preinstall: ./packaging/scripts/preinstall.sh
  postinstall: ./packaging/scripts/postinstall.sh
  preremove: ./packaging/scripts/preremove.sh

overrides:
  deb:
    recommends:
      - systemd
      - sqlite3
  rpm:
    recommends:
      - systemd
      - sqlite
